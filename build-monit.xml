<?xml version="1.0" encoding="UTF-8"?>
<project name="project" default="default">
	<property name="build.dir" value="target" />
	<property name="build.tmp" value="${build.dir}/tmp" />
	<property name="target.dir" value="lib/netty" />
	<property name="target.file" value="netty-monit-client-4.0.0.jar" />

	<target name="default" depends="depends">
		<copyClass />
		
		<antcall target="package" />
		<echo message="copy ${target.file} to  ${target.dir} ..." />
		<copy todir="${target.dir}" file="${build.dir}/${target.file}" />
		<antcall target="clean" />
	</target>

	<macrodef name="copyClass">
		<sequential>
			<copy todir="${build.tmp}" overwrite="true">
				<fileset dir="bin">
					<include name="io/netty/tcp/monit/**" />
					<include name="io/netty/tcp/client/**" />
					<include name="io/netty/tcp/message/**" />
					<include name="io/netty/tcp/serialiaztion/**" />
					<include name="io/netty/tcp/util/**" />
					<exclude name="testor/**.**" />
					<exclude name="logback*.xml" />
				</fileset>
			</copy>
		</sequential>
	</macrodef>
	<target name="package">
		<echo message="项目打包" />
		<jar jarfile="${build.dir}/${target.file}" compress="true" index="false">
			<fileset dir="${build.tmp}">
				<include name="**/**" />
			</fileset>
		</jar>
		<echo message="打包完成: ${build.dir}/${target.file}">
		</echo>
	</target>

	<target name="clean">
		<echo message="清理环境 ..." />
		<delete dir="${build.dir}" />
	</target>
	<target name="init">
		<echo message="初始化环境 ..." />
		<mkdir dir="${build.dir}" />
		<mkdir dir="${build.tmp}" />
	</target>
	<target name="depends">
		<antcall target="clean" />
		<antcall target="init" />
	</target>
</project>
